color = NULL)
school_stat %>%
filter(clean_name %in% c("ha_tinh", "nghe_an")) %>%
filter(education_level == "cap1") %>%
filter(name %in% raw_info$name) %>%
left_join(raw_info)
#2 chart 2: tile on some indicator
school_stat
#2 chart 2: tile on some indicator
school_stat
selectInput("edu", "Education level:", choices =  unique(school_stat$education_level))
#2 chart 2: tile on some indicator
school_stat %>%
filter(! name %in% raw_info$name)
#2 chart 2: tile on some indicator
school_stat %>%
filter(clean_name %in% c("ha_tinh", "nghe_an")) %>%
filter(! name %in% raw_info$name)
#2 chart 2: tile on some indicator
school_stat %>%
filter(clean_name %in% c("ha_tinh", "nghe_an"),
education_level == "cap1") %>%
filter(! name %in% raw_info$name)
#2 chart 2: tile on some indicator
school_stat %>%
filter(clean_name %in% c("ha_tinh", "nghe_an"),
education_level == "cap1") %>%
filter(! name %in% raw_info$name) %>%
split(name)
#2 chart 2: tile on some indicator
school_stat %>%
filter(clean_name %in% c("ha_tinh", "nghe_an"),
education_level == "cap1") %>%
filter(! name %in% raw_info$name)
#2 chart 2: on indicator
school_stat %>%
filter(clean_name %in% c("ha_tinh", "nghe_an"),
education_level == "cap1") %>%
filter(!name %in% raw_info$name) %>%
left_join(raw_info) %>%
mutate(dia_phuong = fct_reorder(dia_phuong, value, .fun = max)) %>%
ggplot(aes(year, value, group = dia_phuong, color = dia_phuong)) +
geom_line()+
scale_y_continuous(labels = comma)+
facet_wrap(~label, scale = "free_y")+
labs(x= NULL,
y= NULL,
color = NULL)
school_stat %>%
filter(clean_name %in% c("ha_tinh", "nghe_an"),
education_level == "cap1") %>%
filter(!name %in% raw_info$name) %>%
left_join(raw_info)
graduate_rate <- read_rds("cleanded-data/education/highschool_graduated.rds")
graduate_rate
#2 chart 2: tile on graduate rate
graduate_rate
#2 chart 2: tile on graduate rate
graduate_rate %>%
filter(clean_name %in% c("ha_tinh", "nghe_an"))
#2 chart 2: tile on graduate rate
graduate_rate %>%
filter(clean_name %in% c("ha_tinh", "nghe_an")) %>%
group_by(year)
#2 chart 2: tile on graduate rate
graduate_rate %>%
filter(clean_name %in% c("ha_tinh", "nghe_an")) %>%
e_charts(year) %>%
e_heatmap(dia_phuong, pct_graduated) %>%
e_visual_map(pct_graduated)
#2 chart 2: tile on graduate rate
graduate_rate %>%
filter(clean_name %in% c("ha_tinh", "nghe_an")) %>%
e_charts(year) %>%
e_heatmap(dia_phuong, pct_graduated) %>%
e_visual_map(pct_graduated) %>%
e_title("abc")
#2 chart 2: tile on graduate rate
graduate_rate %>%
filter(clean_name %in% c("ha_tinh", "nghe_an", "thanh_hoa")) %>%
e_charts(year) %>%
e_heatmap(dia_phuong, pct_graduated) %>%
e_visual_map(pct_graduated) %>%
e_title("abc")
graduate_rate
#1 chart on raw data
(school_stat %>%
filter(clean_name %in% input$prov) %>%
filter(education_level %in% input$edu) %>%
filter(name %in% raw_info$name) %>%
left_join(raw_info) %>%
mutate(dia_phuong = fct_reorder(dia_phuong, value, .fun = max)) %>%
ggplot(aes(year, value, group = dia_phuong, color = dia_phuong)) +
geom_line()+
scale_y_continuous(labels = comma)+
facet_wrap(~label, scale = "free_y")+
labs(x= NULL,
y= NULL,
color = NULL)) %>%
ggplotly()
1+1
(school_stat %>%
filter(clean_name %in% c("ha_noi", "ho_chi_minh")) %>%
filter(education_level %in% input$edu) %>%
filter(name %in% raw_info$name) %>%
left_join(raw_info) %>%
mutate(dia_phuong = fct_reorder(dia_phuong, value, .fun = max)) %>%
ggplot(aes(year, value, group = dia_phuong, color = dia_phuong)) +
geom_line()+
scale_y_continuous(labels = comma, n.breaks = 5)+
facet_wrap(~label, scale = "free_y")+
labs(x= NULL,
y= NULL,
color = NULL)) %>%
ggplotly()
(school_stat %>%
filter(clean_name %in% c("ha_noi", "ho_chi_minh")) %>%
filter(education_level %in% "cap1") %>%
filter(name %in% raw_info$name) %>%
left_join(raw_info) %>%
mutate(dia_phuong = fct_reorder(dia_phuong, value, .fun = max)) %>%
ggplot(aes(year, value, group = dia_phuong, color = dia_phuong)) +
geom_line()+
scale_y_continuous(labels = comma, n.breaks = 5)+
facet_wrap(~label, scale = "free_y")+
labs(x= NULL,
y= NULL,
color = NULL)) %>%
ggplotly()
(school_stat %>%
filter(clean_name %in% c("ha_noi", "ho_chi_minh")) %>%
filter(education_level %in% "cap1") %>%
filter(name %in% raw_info$name) %>%
left_join(raw_info) %>%
mutate(dia_phuong = fct_reorder(dia_phuong, value, .fun = max)) %>%
ggplot(aes(year, value, group = dia_phuong, color = dia_phuong)) +
geom_line()+
scale_y_continuous(labels = comma, breaks = seq(2002, 2019 ,2))+
facet_wrap(~label, scale = "free_y")+
labs(x= NULL,
y= NULL,
color = NULL)) %>%
ggplotly()
school_stat %>%
filter(clean_name %in% c("ha_noi", "ho_chi_minh")) %>%
filter(education_level %in% "cap1") %>%
filter(name %in% raw_info$name) %>%
left_join(raw_info) %>%
mutate(dia_phuong = fct_reorder(dia_phuong, value, .fun = max)) %>%
ggplot(aes(year, value, group = dia_phuong, color = dia_phuong)) +
geom_line()+
scale_y_continuous(labels = comma, breaks = seq(2002, 2019 ,2))+
facet_wrap(~label, scale = "free_y")
(school_stat %>%
filter(clean_name %in% c("ha_noi", "ho_chi_minh")) %>%
filter(education_level %in% "cap1") %>%
filter(name %in% raw_info$name) %>%
left_join(raw_info) %>%
mutate(dia_phuong = fct_reorder(dia_phuong, value, .fun = max)) %>%
ggplot(aes(year, value, group = dia_phuong, color = dia_phuong)) +
geom_line()+
scale_y_continuous(labels = comma,n.breaks = 2)+
facet_wrap(~label, scale = "free_y")+
labs(x= NULL,
y= NULL,
color = NULL)) %>%
ggplotly()
(school_stat %>%
filter(clean_name %in% c("ha_noi", "ho_chi_minh")) %>%
filter(education_level %in% "cap1") %>%
filter(name %in% raw_info$name) %>%
left_join(raw_info) %>%
mutate(dia_phuong = fct_reorder(dia_phuong, value, .fun = max)) %>%
ggplot(aes(year, value, group = dia_phuong, color = dia_phuong)) +
geom_line()+
scale_y_continuous(labels = comma)+
scale_x_continuous(n.breaks = 5)
facet_wrap(~label, scale = "free_y")+
labs(x= NULL,
y= NULL,
color = NULL)) %>%
ggplotly()
(school_stat %>%
filter(clean_name %in% c("ha_noi", "ho_chi_minh")) %>%
filter(education_level %in% "cap1") %>%
filter(name %in% raw_info$name) %>%
left_join(raw_info) %>%
mutate(dia_phuong = fct_reorder(dia_phuong, value, .fun = max)) %>%
ggplot(aes(year, value, group = dia_phuong, color = dia_phuong)) +
geom_line()+
scale_y_continuous(labels = comma)+
scale_x_continuous(n.breaks = 5)+
facet_wrap(~label, scale = "free_y")+
labs(x= NULL,
y= NULL,
color = NULL)) %>%
ggplotly()
(school_stat %>%
filter(clean_name %in% c("ha_noi", "ho_chi_minh")) %>%
filter(education_level %in% "cap1") %>%
filter(name %in% raw_info$name) %>%
left_join(raw_info) %>%
mutate(dia_phuong = fct_reorder(dia_phuong, value, .fun = max)) %>%
ggplot(aes(year, value, group = dia_phuong, color = dia_phuong)) +
geom_line()+
scale_y_continuous(labels = comma)+
scale_x_continuous(n.breaks = 5)+
facet_wrap(~label, scale = "free_y")+
labs(x= NULL,
y= NULL,
color = NULL)) %>%
ggplotly()
(school_stat %>%
filter(clean_name %in% c("ha_noi", "ho_chi_minh")) %>%
filter(education_level %in% "cap1") %>%
filter(name %in% raw_info$name) %>%
left_join(raw_info) %>%
mutate(dia_phuong = fct_reorder(dia_phuong, value, .fun = max)) %>%
ggplot(aes(year, value, group = dia_phuong, color = dia_phuong)) +
geom_line()+
scale_y_continuous(labels = comma)+
facet_wrap(~label, scale = "free_y")+
labs(x= NULL,
y= NULL,
color = NULL)) %>%
ggplotly()
(school_stat %>%
filter(clean_name %in% c("ha_noi", "ho_chi_minh")) %>%
filter(education_level %in% "cap1") %>%
filter(name %in% raw_info$name) %>%
left_join(raw_info) %>%
mutate(dia_phuong = fct_reorder(dia_phuong, value, .fun = max)) %>%
ggplot(aes(year, value, group = dia_phuong, color = dia_phuong)) +
geom_line()+
scale_y_continuous(labels = comma)+
scale_x_continuous(labels =  seq(2002, 2019,2))+
facet_wrap(~label, scale = "free_y")+
labs(x= NULL,
y= NULL,
color = NULL)) %>%
ggplotly()
school_stat
(school_stat %>%
filter(clean_name %in% c("ha_noi", "ho_chi_minh")) %>%
filter(education_level %in% "cap1") %>%
filter(name %in% raw_info$name) %>%
left_join(raw_info) %>%
mutate(dia_phuong = fct_reorder(dia_phuong, value, .fun = max)) %>%
ggplot(aes(year, value, group = dia_phuong, color = dia_phuong)) +
geom_line()+
scale_y_continuous(labels = comma)+
scale_x_discrete(labels =  seq(2002, 2019,2))+
facet_wrap(~label, scale = "free_y")+
labs(x= NULL,
y= NULL,
color = NULL)) %>%
ggplotly()
(school_stat %>%
filter(clean_name %in% c("ha_noi", "ho_chi_minh")) %>%
filter(education_level %in% "cap1") %>%
filter(name %in% raw_info$name) %>%
left_join(raw_info) %>%
mutate(dia_phuong = fct_reorder(dia_phuong, value, .fun = max)) %>%
ggplot(aes(year, value, group = dia_phuong, color = dia_phuong)) +
geom_line()+
scale_y_continuous(labels = comma)+
scale_x_discrete(n.breaks = 4)+
facet_wrap(~label, scale = "free_y")+
labs(x= NULL,
y= NULL,
color = NULL)) %>%
ggplotly()
(school_stat %>%
filter(clean_name %in% c("ha_noi", "ho_chi_minh")) %>%
filter(education_level %in% "cap1") %>%
filter(name %in% raw_info$name) %>%
left_join(raw_info) %>%
mutate(dia_phuong = fct_reorder(dia_phuong, value, .fun = max)) %>%
ggplot(aes(year, value, group = dia_phuong, color = dia_phuong)) +
geom_line()+
scale_y_continuous(labels = comma)+
scale_x_discrete(n.breaks = 4)+
facet_wrap(~label, scale = "free_y")+
labs(x= NULL,
y= NULL,
color = NULL)) %>%
ggplotly()
(school_stat %>%
filter(clean_name %in% c("ha_noi", "ho_chi_minh")) %>%
filter(education_level %in% "cap1") %>%
filter(name %in% raw_info$name) %>%
left_join(raw_info) %>%
mutate(dia_phuong = fct_reorder(dia_phuong, value, .fun = max)) %>%
ggplot(aes(year, value, group = dia_phuong, color = dia_phuong)) +
geom_line()+
scale_y_continuous(labels = comma)+
scale_x_discrete()+
facet_wrap(~label, scale = "free_y")+
labs(x= NULL,
y= NULL,
color = NULL)) %>%
ggplotly()
(school_stat %>%
filter(clean_name %in% c("ha_noi", "ho_chi_minh")) %>%
filter(education_level %in% "cap1") %>%
filter(name %in% raw_info$name) %>%
left_join(raw_info) %>%
mutate(dia_phuong = fct_reorder(dia_phuong, value, .fun = max)) %>%
ggplot(aes(year, value, group = dia_phuong, color = dia_phuong)) +
geom_line()+
scale_y_continuous(labels = comma)+
scale_x_discrete(breaks = seq(2002, 2019, 3))+
facet_wrap(~label, scale = "free_y")+
labs(x= NULL,
y= NULL,
color = NULL)) %>%
ggplotly()
(school_stat %>%
filter(clean_name %in% c("ha_noi", "ho_chi_minh")) %>%
filter(education_level %in% "cap1") %>%
filter(name %in% raw_info$name) %>%
left_join(raw_info) %>%
mutate(dia_phuong = fct_reorder(dia_phuong, value, .fun = max)) %>%
ggplot(aes(year, value, group = dia_phuong, color = dia_phuong)) +
geom_line()+
scale_y_continuous(labels = comma)+
scale_x_discrete(breaks = seq(2002, 2019, 4))+
facet_wrap(~label, scale = "free_y")+
labs(x= NULL,
y= NULL,
color = NULL)) %>%
ggplotly()
(school_stat %>%
filter(clean_name %in% c("ha_noi", "ho_chi_minh")) %>%
filter(education_level %in% "cap1") %>%
filter(name %in% raw_info$name) %>%
left_join(raw_info) %>%
mutate(dia_phuong = fct_reorder(dia_phuong, value, .fun = max)) %>%
ggplot(aes(year, value, group = dia_phuong, color = dia_phuong)) +
geom_line()+
scale_y_continuous(labels = comma)+
scale_x_discrete(breaks = seq(2002, 2019, 4))+
facet_wrap(~label, scale = "free_y")+
labs(x= NULL,
y= NULL,
color = NULL)) %>%
ggplotly()
school_stat <- read_rds("cleanded-data/education/n_school-student-teacher.rds")
school_stat <- school_stat %>%
mutate(clean_name = if_else(clean_name == "tp_ho_chi_minh", "ho_chi_minh", clean_name)) %>%
mutate(stu_class = n_student/ n_class,
teacher_class= n_teacher/ n_class,
stu_teacher= n_student/n_teacher) %>%
pivot_longer(cols = -c(clean_name, dia_phuong, year, education_level)) %>%
mutate(value = round(value,1))
school_stat <- read_rds("cleanded-data/education/n_school-student-teacher.rds")
school_stat %>%
mutate(clean_name = if_else(clean_name == "tp_ho_chi_minh", "ho_chi_minh", clean_name)) %>%
mutate(stu_class = n_student/ n_class,
teacher_class= n_teacher/ n_class,
stu_teacher= n_student/n_teacher)
school_stat %>%
mutate(clean_name = if_else(clean_name == "tp_ho_chi_minh", "ho_chi_minh", clean_name)) %>%
mutate(stu_class = n_student/ n_class,
teacher_class= n_teacher/ n_class,
stu_teacher= n_student/n_teacher) %>%
pivot_longer(cols = -c(clean_name, dia_phuong, year, education_level))
school_stat %>%
mutate(clean_name = if_else(clean_name == "tp_ho_chi_minh", "ho_chi_minh", clean_name)) %>%
mutate(stu_class = n_student/ n_class,
teacher_class= n_teacher/ n_class,
stu_teacher= n_student/n_teacher) %>%
pivot_longer(cols = -c(clean_name, dia_phuong, year, education_level)) %>% distinct(name)
unique(school_stat$name)
school_stat <- read_rds("cleanded-data/education/n_school-student-teacher.rds")
school_stat <- school_stat %>%
mutate(clean_name = if_else(clean_name == "tp_ho_chi_minh", "ho_chi_minh", clean_name)) %>%
mutate(stu_class = n_student/ n_class,
teacher_class= n_teacher/ n_class,
stu_teacher= n_student/n_teacher) %>%
pivot_longer(cols = -c(clean_name, dia_phuong, year, education_level)) %>%
mutate(value = round(value,1))
unique(school_stat$name)
category <- setNames(unique(school_stat$name),
c("Number of student",
"Number of teacher",
"Number of school",
"Number of class",
"Student-class-ratio",
"Teacher-class-ratio",
"Student-teacher-ratio")
category
category <- setNames(unique(school_stat$name),
c("Number of student",
"Number of teacher",
"Number of school",
"Number of class",
"Student-class-ratio",
"Teacher-class-ratio",
"Student-teacher-ratio"))
category
remove.packages("data.table")
library(data.table)
shiny::reactiveConsole()
shiny::reactiveConsole(enabled = TRUE)
library(flexdashboard)
library(tidyverse)
library(echarts4r)
library(DT)
library(plotly)
library(here)
library(shiny)
library(scales)
## load file
geojson_map <- read_rds("cleanded-data/geojson_vnmap.rds")
school_stat <- read_rds("cleanded-data/education/n_school-student-teacher.rds")
school_stat <- school_stat %>%
mutate(clean_name = if_else(clean_name == "tp_ho_chi_minh", "ho_chi_minh", clean_name)) %>%
mutate(stu_class = n_student/ n_class,
teacher_class= n_teacher/ n_class,
stu_teacher= n_student/n_teacher) %>%
pivot_longer(cols = -c(clean_name, dia_phuong, year, education_level)) %>%
mutate(value = round(value,1))
education_lvl <- setNames(unique(school_stat$education_level),
c("Elementary school", "Middle school", "High school"))
category <- setNames(unique(school_stat$name),
c("Number of student",
"Number of teacher",
"Number of school",
"Number of class",
"Student-class-ratio",
"Teacher-class-ratio",
"Student-teacher-ratio"))
selectInput("education", "Education Stage", choices = education_lvl )
selectInput("category", "Information", choices = category)
renderEcharts4r({
school_stat %>%
filter(name %in% input$category,
education_level %in% input$education) %>%
group_by(year) %>%
e_charts(clean_name,timeline = TRUE) %>%
e_map_register("vn", geojson_map) %>%
e_map(value, map = "vn") %>%
e_visual_map(value) %>%
e_theme("shine")
})
renderDT({
school_stat %>%
filter(name %in% input$category,
education_level %in% input$education) %>%
select(dia_phuong, name, value) %>%
datatable(extensions = c("Buttons","Responsive"),
options = list(
dom = "Bfrtip",
buttons = c("csv")))
})
## theme and color
theme_set(ggthemes::theme_fivethirtyeight())
theme_facet <- theme(strip.text = element_text(face = "bold", color = "chocolate3",
hjust = .5, size = 12),
strip.background = element_rect(fill = "transparent", linetype = "dotted"))
my_pal<- c("#62959c", "#c19277", "#e1bc91", "#e3d0b9","#9dad7f", "#726a95",
"#d6b0b1", "#8b5e83")
graduate_rate <- read_rds("cleanded-data/education/highschool_graduated.rds")
province <- setNames(unique(school_stat$clean_name), unique(school_stat$dia_phuong))
edu <- setNames(unique(school_stat$education_level),
c("Elementary school", "Middle school", "High school"))
selectInput("prov", "Choose province:",  choices = province, multiple = TRUE, selected = c("ha_tinh", "nghe_an"))
selectInput("edu", "Education level:", choices = edu)
raw_info <- tibble(name = c("n_class", "n_student", "n_teacher", "n_school"),
label = c(
"Number of class",
"Number of student",
"Number of teacher",
"Number of school"
))
#1 chart on raw data
renderPlotly({
(school_stat %>%
filter(clean_name %in% input$prov) %>%
filter(education_level %in% input$edu) %>%
filter(name %in% raw_info$name) %>%
left_join(raw_info) %>%
mutate(dia_phuong = fct_reorder(dia_phuong, value, .fun = max)) %>%
ggplot(aes(year, value, group = dia_phuong, color = dia_phuong)) +
geom_point(size =.5)+
geom_line(size= .3)+
scale_y_continuous(labels = comma, n.breaks = 5)+
scale_x_discrete(breaks = seq(2002, 2019, 3))+
scale_color_manual(values = my_pal[1:length(input$prov)])+
facet_wrap(~label, scale = "free")+
labs(x= NULL,
y= NULL,
color = NULL)+
theme_facet) %>%
ggplotly(tooltip = c("group", "year", "value")) %>%
config(displayModeBar = FALSE)
})
shiny::reactiveConsole(FALSE)
install.packages(""data.table"")
install.packages("data.table")
remove.packages("data.table")
remove.packages("plotly")
install.packages("plotly")
install.packages("plotly")
# render company's revenue and labor force report --------------------------------
rmarkdown::render("Analyzing-vn-companu-labor.Rmd",
output_file = "final-result/Analyzing-company-labor",envir = new.env())
markdown::rpubsUpload(title = "first temp upload",
htmlFile = "final-result/Analyzing-company-labor.html")
markdown::rpubsUpload(title = "first temp upload",
htmlFile = "final-result/Analyzing-company-labor.html")
