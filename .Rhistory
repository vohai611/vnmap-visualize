clean_2(values_to = "female_teacher") %>%
left_join(teacher)
female_teacher %>%
clean_2(values_to = "female_teacher") %>%
left_join(teacher) %>%
mutate(male_teacher = n_teacher - female_teacher)
female_teacher %>%
clean_2(values_to = "female_teacher") %>%
left_join(teacher) %>%
mutate(male_teacher = n_teacher - female_teacher) %>%
filter(male_teacher<0)
teacher
teacher %>%
filter(clean_name == "quang_ninh")
female_teacher %>%
clean_2(values_to = "female_teacher") %>%
left_join(teacher) %>%
mutate(male_teacher = n_teacher - female_teacher) %>%
filter(male_teacher<0)
teacher %>%
filter(clean_name == "quang_ninh")
teacher %>%
filter(clean_name == "quang_ninh", year == "2009")
teacher <- read_csv("raw-data/Education/number-of-teachers.csv") %>%
mutate(across(-1, .fns = as.double))
teacher
View(teacher)
female_teacher %>%
clean_2(values_to = "female_teacher") %>%
left_join(teacher) %>%
mutate(male_teacher = n_teacher - female_teacher) %>%
filter(male_teacher<0)
teacher
teacher <- teacher %>%
clean_2("n_teacher") %>%
select(-dia_phuong)
female_teacher %>%
clean_2(values_to = "female_teacher") %>%
left_join(teacher) %>%
mutate(male_teacher = n_teacher - female_teacher) %>%
filter(male_teacher<0)
female_teacher %>%
clean_2(values_to = "female_teacher") %>%
left_join(teacher) %>%
mutate(male_teacher = n_teacher - female_teacher) %>%
filter(male_teacher > 0)
femalte_student %>%
clean_2("female_student") %>%
left_join(student) %>%
mutate(male_student - n_student - femalte_student) %>%
filter(female_student <0)
femalte_student %>%
clean_2("female_student") %>%
left_join(school_student) %>%
mutate(male_student - n_student - femalte_student) %>%
filter(female_student <0)
femalte_student %>%
clean_2("female_student") %>%
left_join(school_student) %>%
mutate(male_student = n_student - femalte_student) %>%
filter(female_student <0)
school_student
femalte_student %>%
clean_2("female_student")
school_student
femalte_student %>%
clean_2("female_student") %>%
left_join(school_student) %>%
mutate(male_student = n_student - female_student) %>%
filter(female_student <0)
femalte_student %>%
clean_2("female_student") %>%
left_join(school_student) %>%
mutate(male_student = n_student - female_student)
female_teacher %>%
clean_2(values_to = "female_teacher") %>%
left_join(teacher) %>%
mutate(male_teacher = n_teacher - female_teacher) %>%
filter(male_teacher > 0) %>%
write_rds("cleanded-data/education/female_teacher.rds")
femalte_student %>%
clean_2("female_student") %>%
left_join(school_student) %>%
mutate(male_student = n_student - female_student) %>%
write_rds("cleanded-data/education/female_student.rds")
read_rds("cleanded-data/education/female_student.rds")
female_student <- read_rds("cleanded-data/education/female_student.rds")
female_teacher <- read_rds("cleanded-data/education/female_teacher.rds")
student_gender <- read_rds("cleanded-data/education/female_student.rds")
teacher_gender <- read_rds("cleanded-data/education/female_teacher.rds")
student_gender
student_gender %>%
filter(clean_name == "ha_noi")
student_gender %>%
filter(clean_name == "ha_noi") %>%
ggplot(aes())
student_gender %>%
select(- n_student)
library(tidyverse)
#  clean function ----
basic_clean <- function(tbl, values_to) {
remove_region <- c("ca_nuoc",
"tay_nguyen",
"dong_nam_bo",
"dong_bang_song_hong",
"bac_trung_bo_va_duyen_hai_mien_trung",
"trung_du_va_mien_nui_phia_bac",
"dong_bang_song_cuu_long")
tbl %>%
janitor::clean_names() %>%
mutate(clean_name = janitor::make_clean_names(dia_phuong),.before = 1) %>%
pivot_longer(-c(clean_name,dia_phuong), names_to = "year", values_to = values_to) %>%
filter(!clean_name %in% remove_region)
}
clean_2 <- function(tbl, values_to) {
tbl %>%
basic_clean(values_to) %>%
extract(year,
into = c("year", "education_level"),
regex = "x(\\d{4})_(.*)") %>%
mutate(
education_level = case_when(
education_level == "tieu_hoc" ~ "cap1",
education_level %in% c("trung_hoc", "trung_hoc_co_so") ~ "cap2",
education_level %in% c("pho_thong_co_so", "trung_hoc_pho_thong") ~ "cap3",
TRUE ~ education_level
)
) %>%
filter(education_level != "tong_so")
}
# load data ----
highschool_graduated <- read_csv("raw-data/Education/highschool-graduated.csv") %>%
mutate(across(-1, .fns = as.double))
university_student <- read_csv("raw-data/Education/student-university.csv") %>%
mutate(across(-1, .fns = as.double))
school_student <- read_csv("raw-data/Education/n-student_high-school.csv") %>%
mutate(across(-1, .fns = as.double))
teacher <- read_csv("raw-data/Education/number-of-teachers.csv") %>%
mutate(across(-1, .fns = as.double))
school <- read_csv("raw-data/Education/number-schools.csv") %>%
mutate(across(-1, .fns = as.double))
n_class <- read_csv("raw-data/Education/n_class.csv") %>%
mutate(across(-1, .fns = as.double))
female_teacher <- read_csv("raw-data/Education/female-teacher.csv") %>%
mutate(across(-1, .fns = as.double))
femalte_student <-  read_csv("raw-data/Education/female-student.csv") %>%
mutate(across(-1, .fns = as.double))
#dir.create("cleanded-data/education")
# clean data ----
## highschool graduate pct,  university student ----------------------------
highschool_graduated %>%
basic_clean(values_to = "pct_graduated")%>%
mutate(year= as.factor(str_sub(year, 2,5))) %>%
write_rds("cleanded-data/education/highschool_graduated.rds")
university_student %>%
basic_clean(values_to ="n_Ustudent") %>%
mutate(year = as.factor(parse_number(year))) %>%
write_rds("cleanded-data/education/university_student.rds")
##   student - teacher and school ------------------------------------------
school_student <- school_student %>%
clean_2("n_student")
teacher <- teacher %>%
clean_2("n_teacher") %>%
select(-dia_phuong)
school <- school %>%
clean_2("n_school") %>%
group_by(clean_name, dia_phuong, year, education_level) %>%
summarise(n_school = sum(n_school, na.rm = TRUE),.groups = "drop") %>%
select(-dia_phuong)
n_class <- n_class %>%
clean_2("n_class") %>%
select(-dia_phuong)
female_teacher
female_teacher %>%
clean_2(values_to = "female_teacher") %>%
left_join(teacher) %>%
mutate(male_teacher = n_teacher - female_teacher) %>%
filter(male_teacher > 0)
female_teacher %>%
clean_2(values_to = "female_teacher") %>%
left_join(teacher) %>%
mutate(male_teacher = n_teacher - female_teacher) %>%
filter(male_teacher > 0) %>%
select(-n_teacher) %>%
pivot_longer(c(female_teacher, male_teacher))
female_teacher %>%
clean_2(values_to = "female_teacher") %>%
left_join(teacher) %>%
mutate(male_teacher = n_teacher - female_teacher) %>%
filter(male_teacher > 0) %>%
select(-n_teacher) %>%
pivot_longer(c(female_teacher, male_teacher), "gender", "value")
female_teacher %>%
clean_2(values_to = "female_teacher") %>%
left_join(teacher) %>%
mutate(male_teacher = n_teacher - female_teacher) %>%
filter(male_teacher > 0) %>%
select(-n_teacher) %>%
pivot_longer(c(female_teacher, male_teacher), "gender", "value") %>%
write_rds("cleanded-data/education/female_teacher.rds")
femalte_student %>%
clean_2("female_student") %>%
left_join(school_student) %>%
mutate(male_student = n_student - female_student) %>%
select(-n_student) %>%
pivot_longer(c(female_student, male_student), "gender", "value")
femalte_student %>%
clean_2("female_student") %>%
left_join(school_student) %>%
mutate(male_student = n_student - female_student) %>%
select(-n_student) %>%
pivot_longer(c(female_student, male_student), "gender", "value") %>%
write_rds("cleanded-data/education/female_student.rds")
student_gender %>%
filter(clean_name == "ha_noi")
student_gender <- read_rds("cleanded-data/education/female_student.rds")
teacher_gender <- read_rds("cleanded-data/education/female_teacher.rds")
student_gender %>%
filter(clean_name == "ha_noi")
student_gender %>%
filter(clean_name == "ha_noi") %>%
ggplot(aes(year, value, fill = gender))+
geom_point()+
facet_wrap(education_level)
student_gender %>%
filter(clean_name == "ha_noi") %>%
ggplot(aes(year, value, fill = gender))+
geom_point()+
facet_wrap(~education_level)
student_gender %>%
filter(clean_name == "ha_noi") %>%
ggplot(aes(year, value, coloeo = gender))+
geom_point()+
facet_wrap(~education_level)
student_gender %>%
filter(clean_name == "ha_noi") %>%
ggplot(aes(year, value, color = gender))+
geom_point()+
facet_wrap(~education_level)
student_gender %>%
filter(clean_name == "ha_tinh") %>%
ggplot(aes(year, value, color = gender))+
geom_point()+
facet_wrap(~education_level)
student_gender %>%
filter(clean_name == "ha_tinh") %>%
ggplot(aes(year, value, color = gender, group = gender))+
geom_point()+
geom_line()
student_gender %>%
filter(clean_name == "ha_tinh") %>%
ggplot(aes(year, value, color = gender, group = gender))+
geom_point()+
geom_line()+
facet_wrap(~education_level)
teacher_gender %>%
filter(clean_name == "ha_tinh") %>%
ggplot(aes(year, value, color = gender, group = gender))+
geom_point()+
geom_line()+
facet_wrap(~education_level)
student_gender %>%
filter(clean_name == "ha_tinh") %>%
ggplot(aes(year, value, color = gender, group = gender))+
geom_point()+
geom_line()+
facet_wrap(~education_level)
student_gender %>%
filter(clean_name == "ha_tinh") %>%
ggplot(aes(year, value, color = gender, group = gender))+
geom_point()+
geom_line()+
facet_wrap(~education_level)
student_gender %>%
filter(clean_name == "ha_tinh")
teacher_gender %>%
filter(clean_name == "ha_tinh") %>%
ggplot(aes(year, value, color = gender, group = gender))+
geom_point()+
geom_line()+
facet_wrap(~education_level)
runApp('education-dashboard/education-dash-board.R')
runApp('education-dashboard/education-dash-board.R')
runApp('education-dashboard/education-dash-board.R')
?icon
runApp('education-dashboard/education-dash-board.R')
teacher_gender %>%
filter(clean_name == "ha_tinh") %>%
ggplot(aes(year, value, color = gender, group = gender))+
geom_point()+
geom_line()+
facet_wrap(~education_level)
teacher_gender %>%
filter(clean_name == "ha_tinh") %>%
ggplot(aes(year, value, color = gender, group = gender))+
geom_point()+
geom_line()+
facet_wrap(~education_level)
teacher_gender %>%
filter(clean_name == "ha_tinh") %>%
ggplot(aes(year, value, color = gender, group = gender))+
geom_point()+
geom_line()+
facet_wrap(~education_level)+
labs(title = "sdfasdf")
teacher_gender %>%
filter(clean_name == "ha_tinh") %>%
ggplot(aes(year, value, color = gender, group = gender))+
geom_point()+
geom_line()+
facet_wrap(~education_level)+
labs(title = "sdfasdf")+
theme(plot.title = element_text(margin = margin(b = 3)))
teacher_gender %>%
filter(clean_name == "ha_tinh") %>%
ggplot(aes(year, value, color = gender, group = gender))+
geom_point()+
geom_line()+
facet_wrap(~education_level)+
labs(title = "sdfasdf")+
theme(plot.title = element_text(margin = margin(b = 30)))
runApp('education-dashboard/education-dash-board.R')
school_stat
rename_education <- function(x){
case_when(x == "cap1" ~ "Elementary school",
x == "cap2" ~ "Middle school",
x == "cap3" ~ "High school")
}
rename_education <- . %>%
mutate(education_level =case_when(education_level == "cap1" ~ "Elementary school",
education_level == "cap2" ~ "Middle school",
education_level == "cap3" ~ "High school"))
school_stat <- read_rds(here("cleanded-data/education/n_school-student-teacher.rds")) %>%
rename_education()
student_gender <- read_rds(here("cleanded-data/education/female_student.rds")) %>%
rename_education()
teacher_gender <- read_rds(here("cleanded-data/education/female_teacher.rds")) %>%
rename_education()
runApp('education-dashboard/education-dash-board.R')
student_gender <- read_rds(here("cleanded-data/education/female_student.rds"))
student_gender
runApp('education-dashboard/education-dash-board.R')
runApp('education-dash-board.R')
factor(letter[1:3])
letter
factor(letters[1:3])
factor(letters[1:3], levels = c("c","a", "b"))
## rename education level to english
rename_education <- . %>%
mutate(education_level = factor(education_level, levels = c("cap1", "cap2", "cap3"),
education_level = case_when(education_level == "cap1" ~ "Elementary school",
education_level == "cap2" ~ "Middle school",
education_level == "cap3" ~ "High school")
))
school_stat <- read_rds(here("cleanded-data/education/n_school-student-teacher.rds")) %>%
rename_education()
## rename education level to english
rename_education <- . %>%
mutate(education_level = factor(education_level, levels = c("cap1", "cap2", "cap3")),
education_level = case_when(education_level == "cap1" ~ "Elementary school",
education_level == "cap2" ~ "Middle school",
education_level == "cap3" ~ "High school")
))
## rename education level to english
rename_education <- . %>%
mutate(education_level = factor(education_level, levels = c("cap1", "cap2", "cap3")),
education_level = case_when(education_level == "cap1" ~ "Elementary school",
education_level == "cap2" ~ "Middle school",
education_level == "cap3" ~ "High school")
)
school_stat <- read_rds(here("cleanded-data/education/n_school-student-teacher.rds")) %>%
rename_education()
runApp('education-dashboard/education-dash-board.R')
school_stat
school_stat <- read_rds(here("cleanded-data/education/n_school-student-teacher.rds")) %>%
rename_education()
school_stat
## rename education level to english
rename_education <- . %>%
mutate(education_level = case_when(education_level == "cap1" ~ "Elementary school",
education_level == "cap2" ~ "Middle school",
education_level == "cap3" ~ "High school"),
education_level = factor(education_level,
levels = c("Elementary school", "Middle school", "High school"))
)
school_stat <- read_rds(here("cleanded-data/education/n_school-student-teacher.rds")) %>%
rename_education()
school_stat
runApp('education-dashboard/education-dash-board.R')
library(shiny); runApp('education-dashboard/education-dash-board.R')
library(shiny); runApp('education-dashboard/education-dash-board.R')
runApp('education-dashboard/education-dash-board.R')
runApp('education-dashboard/education-dash-board.R')
runApp('education-dashboard/education-dash-board.R')
runApp('education-dashboard/education-dash-board.R')
library(tidyverse)
library(shiny)
library(echarts4r)
library(DT)
library(janitor)
library(shinydashboard)
library(glue)
library(plotly)
library(scales)
library(here)
# styling theme and color --------------------------------------------------
theme_facet <- theme_light() +
theme(
strip.text = element_text(
face = "bold",
color = "chocolate3",
hjust = .5,
size = 11
),
text = element_text(family = "Montserrat"),
strip.background = element_rect(fill = "gray90", color = "transparent"),
panel.grid.major.y = element_line(colour = "white", linetype = 3),
plot.background = element_rect(fill = "#E7D5BD"),
panel.background = element_rect(fill = "grey90")
)
my_pal<- c("#62959c", "#c19277", "#e1bc91", "#e3d0b9","#9dad7f", "#726a95",
"#d6b0b1", "#8b5e83")
## rename education level to english-----
rename_education <- . %>%
mutate(education_level = case_when(education_level == "cap1" ~ "Elementary school",
education_level == "cap2" ~ "Middle school",
education_level == "cap3" ~ "High school"),
education_level = factor(education_level,
levels = c("Elementary school", "Middle school", "High school"))
)
## Load the data ----
school_stat <- read_rds(here("cleanded-data/education/n_school-student-teacher.rds")) %>%
rename_education()
hs_graduated <- read_rds(here("cleanded-data/education/highschool_graduated.rds"))
student_gender <- read_rds(here("cleanded-data/education/female_student.rds")) %>%
rename_education()
teacher_gender <- read_rds(here("cleanded-data/education/female_teacher.rds")) %>%
rename_education()
# match display UI and server name
equal_name <- school_stat %>%
distinct(clean_name, dia_phuong)
# load map for echart
geojson_vn <- read_rds(here("cleanded-data/geojson_vnmap.rds"))
df <- school_stat %>%
mutate(year = as.factor(year)) %>%
filter(clean_name == province_selected()) %>%
pivot_longer(c(n_student,n_teacher, n_school, n_class)) %>%
mutate(name = case_when(name == "n_class" ~  "Number of classes",
name == "n_student" ~  "Number of students",
name == "n_teacher" ~  "Number of teachers",
name == "n_school" ~ "Number of schools"))
plot <-  df %>%
ggplot(aes(year, value, color = education_level, group = education_level,
text = glue("Year: {year}
value: {comma(round(value,-1))}")))+
geom_line(size = .4, alpha = .6)+
geom_point(size = .8)+
labs(title =glue("{df$dia_phuong[[1]]} Province"),
subtitle = " ",
x = NULL,
y= NULL,
color = NULL)+
scale_color_manual(values = my_pal[1:3],
labels = c("Elementary", "Middle school", "High school"))+
scale_x_discrete(breaks = seq(2002, 2019, 3))+
scale_y_continuous(labels = comma)+
facet_wrap(~name, scale = "free")+
theme_facet
df<- school_stat %>% filter(dia_phuong == "ha_tinh")
plot <-  df %>%
ggplot(aes(year, value, color = education_level, group = education_level,
text = glue("Year: {year}
value: {comma(round(value,-1))}")))+
geom_line(size = .4, alpha = .6)+
geom_point(size = .8)+
labs(title =glue("{df$dia_phuong[[1]]} Province"),
subtitle = " ",
x = NULL,
y= NULL,
color = NULL)+
scale_color_manual(values = my_pal[1:3],
labels = c("Elementary", "Middle school", "High school"))+
scale_x_discrete(breaks = seq(2002, 2019, 3))+
scale_y_continuous(labels = comma)+
facet_wrap(~name, scale = "free")+
theme_facet
plot <-  df %>%
ggplot(aes(year, value, color = education_level, group = education_level,
text = glue("Year: {year}
value: {comma(round(value,-1))}")))+
geom_line(size = .4, alpha = .6)+
geom_point(size = .8)+
labs(title =glue("{#df$dia_phuong[[1]]} Province"),
subtitle = " ",
x = NULL,
y= NULL,
color = NULL)+
scale_color_manual(values = my_pal[1:3],
labels = c("Elementary", "Middle school", "High school"))+
scale_x_discrete(breaks = seq(2002, 2019, 3))+
scale_y_continuous(labels = comma)+
facet_wrap(~name, scale = "free")+
theme_facet
ggplotly(plot, tooltip = "text") %>%
layout(hovermode = "x")
plot
runApp('education-dashboard/education-dash-board.R')
install.packages("shinythemes")
runApp('education-dashboard/education-dash-board.R')
install.packages("dashboardthemes")
runApp('education-dashboard/education-dash-board.R')
runApp('education-dashboard/education-dash-board.R')
