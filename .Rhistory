slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_label(position = position_nudge(), aes(label = round(labor_over_pop,1)))
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2017) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_label(position = position_nudge(), aes(label = 100*round(labor_over_pop)))
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2017) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_label(position = position_nudge(), aes(label = 100*round(labor_over_pop,1)))
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2017) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_label(position = position_nudge(), aes(label = 100*round(labor_over_pop,2)))
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2017) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_label(position = position_nudge(), aes(label = 100*round(labor_over_pop,3)))
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2017) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_text(position = position_nudge(), aes(label = 100*round(labor_over_pop,3)))
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2017) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_text(position = position_nudge(x = labor_over_pop/2), aes(label = 100*round(labor_over_pop,3)))
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2017) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_text(aes(label = 100*round(labor_over_pop,3)))
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2017) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_text(aes(x = labor_over_pop/2, label = 100*round(labor_over_pop,3)))
scale_x_continuous(labels = percent,n.breaks = 10)+
scale_fill_manual(values = c("#66B38BF6", "#A14442"))+
labs(title = "Percen of labor over town population",
x= "",
y = "")+
theme_void()
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2017) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_text(aes(x = labor_over_pop/2, label = 100*round(labor_over_pop,3)))+
scale_x_continuous(labels = percent,n.breaks = 10)+
scale_fill_manual(values = c("#66B38BF6", "#A14442"))+
labs(title = "Percen of labor over town population",
x= "",
y = "")+
theme_void()
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2017) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_text(aes(x = labor_over_pop/2, label = 100*round(labor_over_pop,3)))+
scale_x_continuous(labels = percent,n.breaks = 10)+
scale_fill_manual(values = c("#66B38BF6", "#A14442"))+
labs(title = "Percen of labor over town population",
x= "",
y = "")+
theme_void()+
theme(axis.title.y = element_text())
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2017) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_text(aes(x = labor_over_pop/2, label = 100*round(labor_over_pop,3)))+
scale_x_continuous(labels = percent,n.breaks = 10)+
scale_fill_manual(values = c("#66B38BF6", "#A14442"))+
labs(title = "Percen of labor over town population",
x= "",
y = "")+
theme_void()+
theme(axis.ticks.y.left =  = element_line())
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2017) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_text(aes(x = labor_over_pop/2, label = 100*round(labor_over_pop,3)))+
scale_x_continuous(labels = percent,n.breaks = 10)+
scale_fill_manual(values = c("#66B38BF6", "#A14442"))+
labs(title = "Percen of labor over town population",
x= "",
y = "")+
theme_void()+
theme(axis.ticks.y.left = element_line())
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2017) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_text(aes(x = labor_over_pop/2, label = 100*round(labor_over_pop,3)))+
scale_x_continuous(labels = percent,n.breaks = 10)+
scale_fill_manual(values = c("#66B38BF6", "#A14442"))+
labs(title = "Percen of labor over town population",
x= "",
y = "")+
theme_minimal()
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2017) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_text(aes(x = labor_over_pop/2, label = 100*round(labor_over_pop,3)))+
scale_x_continuous(labels = percent,n.breaks = 10)+
scale_fill_manual(values = c("#66B38BF6", "#A14442"))+
labs(title = "Percen of labor over town population",
x= "",
y = "")+
theme_minimal()+
theme(axis.line.x = element_blank())
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2017) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_text(aes(x = labor_over_pop/2, label = 100*round(labor_over_pop,3)))+
scale_x_continuous(labels = percent,n.breaks = 10)+
scale_fill_manual(values = c("#66B38BF6", "#A14442"))+
labs(title = "Percen of labor over town population",
x= "",
y = "")+
theme_minimal()
theme(axis.text.x  = element_blank())
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2017) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_text(aes(x = labor_over_pop/2, label = 100*round(labor_over_pop,3)))+
scale_x_continuous(labels = percent,n.breaks = 10)+
scale_fill_manual(values = c("#66B38BF6", "#A14442"))+
labs(title = "Percen of labor over town population",
x= "",
y = "")+
theme_minimal()+
theme(axis.text.x  = element_blank())
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2017) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_text(aes(x = labor_over_pop/2, label = 100*round(labor_over_pop,3)))+
scale_x_continuous(labels = percent,n.breaks = 10)+
scale_fill_manual(values = c("#66B38BF6", "#A14442"))+
labs(title = "Percen of labor over town population",
x= "",
y = "")+
theme_minimal()+
theme(axis.text.x  = element_blank(),line = element_blank())
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2017) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 28) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_text(aes(x = labor_over_pop/2, label = 100*round(labor_over_pop,3)))+
scale_x_continuous(labels = percent,n.breaks = 10)+
scale_fill_manual(values = c("#66B38BF6", "#A14442"))+
labs(title = "Percent of labor over town population",
x= "",
y = "")+
theme_minimal()+
theme(axis.text.x  = element_blank(),line = element_blank())
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2017) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_text(aes(x = labor_over_pop/2, label = 100*round(labor_over_pop,3)))+
scale_x_continuous(labels = percent,n.breaks = 10)+
scale_fill_manual(values = c("#66B38BF6", "#A14442"))+
labs(title = "Percent of labor over town population",
x= "",
y = "")+
theme_minimal()+
theme(axis.text.x  = element_blank(),line = element_blank())
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2017) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_text(aes(x = labor_over_pop/2, label = 100*round(labor_over_pop,3)))+
scale_x_continuous(labels = percent,n.breaks = 10)+
scale_fill_manual(values = c("#66B38BF6", "#A14442"))+
labs(title = "Percent of labor over town population",
subtitle = "Highest and lowest group",
x= "",
y = "")+
theme_minimal()+
theme(axis.text.x  = element_blank(),line = element_blank())
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2017) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_text(aes(x = labor_over_pop/2, label = 100*round(labor_over_pop,3)), color ="white")+
scale_x_continuous(labels = percent,n.breaks = 10)+
scale_fill_manual(values = c("#66B38BF6", "#A14442"))+
labs(title = "Percent of labor over town population",
subtitle = "Highest and lowest group",
x= "",
y = "")+
theme_minimal()+
theme(axis.text.x  = element_blank(),line = element_blank())
# read data
data <- read_rds("cleanded-data/area-population.rds")
vnmap <- read_rds("cleanded-data/vnmap.rds") %>%
arrange(id) %>%
group_by(id) %>%
mutate(town_id = cur_group_id())
vnmap
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2017) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_text(aes(x = labor_over_pop/2, label = 100*round(labor_over_pop,3)), color ="white")+
scale_x_continuous(labels = percent,n.breaks = 10)+
scale_fill_manual(values = c("#66B38BF6", "#A14442"))+
labs(title = "Percent of labor over town population",
subtitle = "Highest and lowest group",
x= "",
y = "")+
theme_minimal()+
theme(axis.text.x  = element_blank(),line = element_blank())
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2018) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_text(aes(x = labor_over_pop/2, label = 100*round(labor_over_pop,3)), color ="white")+
scale_x_continuous(labels = percent,n.breaks = 10)+
scale_fill_manual(values = c("#66B38BF6", "#A14442"))+
labs(title = "Percent of labor over town population",
subtitle = "Highest and lowest group",
x= "",
y = "")+
theme_minimal()+
theme(axis.text.x  = element_blank(),line = element_blank())
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2016) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_text(aes(x = labor_over_pop/2, label = 100*round(labor_over_pop,3)), color ="white")+
scale_x_continuous(labels = percent,n.breaks = 10)+
scale_fill_manual(values = c("#66B38BF6", "#A14442"))+
labs(title = "Percent of labor over town population",
subtitle = "Highest and lowest group",
x= "",
y = "")+
theme_minimal()+
theme(axis.text.x  = element_blank(),line = element_blank())
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2018) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_text(aes(x = labor_over_pop/2, label = 100*round(labor_over_pop,3)), color ="white")+
scale_x_continuous(labels = percent,n.breaks = 10)+
scale_fill_manual(values = c("#66B38BF6", "#A14442"))+
labs(title = "Percent of labor over town population",
subtitle = "Highest and lowest group",
x= "",
y = "")+
theme_minimal()+
theme(axis.text.x  = element_blank(),line = element_blank())
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2016) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_text(aes(x = labor_over_pop/2, label = 100*round(labor_over_pop,3)), color ="white")+
scale_x_continuous(labels = percent,n.breaks = 10)+
scale_fill_manual(values = c("#66B38BF6", "#A14442"))+
labs(title = "Percent of labor over town population",
subtitle = "Highest and lowest group",
x= "",
y = "")+
theme_minimal()+
theme(axis.text.x  = element_blank(),line = element_blank())
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2018) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
slice_max(abs(labor_over_pop - mean(labor_over_pop)) , n = 30) %>%
mutate(tinh_thanh_pho.x = fct_reorder(tinh_thanh_pho.x, labor_over_pop),
high_low = as.numeric(tinh_thanh_pho.x) > 15) %>%
ggplot(aes(labor_over_pop, tinh_thanh_pho.x, fill = high_low))+
geom_col(show.legend = FALSE)+
geom_text(aes(x = labor_over_pop/2, label = 100*round(labor_over_pop,3)), color ="white")+
scale_x_continuous(labels = percent,n.breaks = 10)+
scale_fill_manual(values = c("#66B38BF6", "#A14442"))+
labs(title = "Percent of labor over town population",
subtitle = "Highest and lowest group",
x= "",
y = "")+
theme_minimal()+
theme(axis.text.x  = element_blank(),line = element_blank())
source("echart-functions/custom_echart_town.R")
View(custom_echart_town)
library(purrr)
## raster data
country <- raster::getData("GADM", country = country, level = 1)
## raster data
country <- raster::getData("GADM", country = "Vietnam", level = 1)
View(country)
names(country)
## rename
names(country)[5]<- "name"
## convert to json map
geojson_map <- geojsonio::geojson_list(country)
geojson_map
# map by echarts
labor
View(geojson_map)
## rename
names(country)[4]<- "name"
country
View(country)
## convert to json map
geojson_map <- geojsonio::geojson_list(country)
# map by echarts
labor
labor %>%
#mutate(region = row.names(.)) %>%
e_charts(tinh_thanh_pho) %>%
e_map_register("vn", geojson_map) %>%
e_map(value, map = "vn") %>%
e_visual_map(n_labor) %>%
e_theme("infographic")
# map by echarts
library(echarts4r
# map by echarts
library(echarts4r)
labor %>%
#mutate(region = row.names(.)) %>%
e_charts(tinh_thanh_pho) %>%
e_map_register("vn", geojson_map) %>%
e_map(value, map = "vn") %>%
e_visual_map(n_labor) %>%
e_theme("infographic")
labor %>%
#mutate(region = row.names(.)) %>%
e_charts(tinh_thanh_pho) %>%
e_map_register("vn", geojson_map) %>%
e_map(n_labor, map = "vn") %>%
e_visual_map(n_labor) %>%
e_theme("infographic")
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2019)
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2018)
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
filter(year == 2018) %>%
e_charts(tinh_thanh_pho.x) %>%
e_map_register("vn", geojson_map) %>%
e_map(n_labor, map = "vn") %>%
e_visual_map(n_labor) %>%
e_theme("infographic")
labor %>%
inner_join(danso, by = c("year", "clean_name"))
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
filter(year == 2018) %>%
e_charts(tinh_thanh_pho.x) %>%
e_map_register("vn", geojson_map) %>%
e_map(n_labor, map = "vn") %>%
e_visual_map(n_labor) %>%
e_theme("infographic")
labor %>%
inner_join(danso, by = c("year", "clean_name")) %>%
mutate(labor_over_pop = n_labor/1000/ pop_1000) %>%
filter(year == 2018) %>%
e_charts(tinh_thanh_pho.x) %>%
e_map_register("vn", geojson_map) %>%
e_map(labor_over_pop, map = "vn") %>%
e_visual_map(labor_over_pop) %>%
e_theme("infographic")
