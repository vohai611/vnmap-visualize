## clean data
library(tidyverse )
dtich_danso <- read_csv("raw-data/dientich_danso.csv")
dtich_danso
dtich_danso %>%
janitor::clean_names()
janitor::clean_names("một")
janitor::clean_names(c("một"))
janitor::clean_names(c("một", "hai"))
janitor::make_clean_names(c("một", "hai"))
dtich_danso %>%
janitor::clean_names()
dtich_danso %>%
janitor::clean_names() %>%
mutate(dia_phuong = janitor::make_clean_names(dia_phuong))
dtich_danso %>%
janitor::clean_names() %>%
mutate(dia_phuong = janitor::make_clean_names(dia_phuong,sep_in = " "))
dtich_danso %>%
janitor::clean_names() %>%
mutate(dia_phuong = janitor::make_clean_names(dia_phuong,sep_in = "\\s"))
dtich_danso %>%
janitor::clean_names() %>%
mutate(dia_phuong = janitor::make_clean_names(dia_phuong))
dtich_danso %>%
janitor::clean_names() %>%
mutate(dia_phuong = janitor::make_clean_names(dia_phuong, case = "old_janitor"))
dtich_danso %>%
janitor::clean_names() %>%
mutate(dia_phuong = janitor::make_clean_names(dia_phuong, sep_out = " "))
dtich_danso %>%
janitor::clean_names() %>%
mutate(dia_phuong = janitor::make_clean_names(dia_phuong, sep_out = " "),
dia_phuong = str_to_title(dia_phuong)))
dtich_danso %>%
janitor::clean_names() %>%
mutate(dia_phuong = janitor::make_clean_names(dia_phuong, sep_out = " "),
dia_phuong = str_to_title(dia_phuong))
dtich_danso %>%
janitor::clean_names() %>%
pivot_longer(-dia_phuong, names_to = c("year", ".value"), names_pattern = "x(\\d{4})_(.*)")
dtich_danso %>%
janitor::clean_names() %>%
pivot_longer(-dia_phuong, names_to = c("year", ".value"), names_pattern = "x(\\d{4})_(.*)") %>%
mutate(dia_phuong = str_to_title(dia_phuong))
dtich_danso <- dtich_danso %>%
janitor::clean_names()
dtich_danso
dtich_danso %>%
arrange(2)
dtich_danso %>%
arrange(2) %>%
select(1,2)
dtich_danso %>%
arrange(desc(2)) %>%
select(1,2)
dtich_danso %>%
arrange(desc(x2011_dan_so_trung_binh_nghin_nguoi)) %>%
select(1,2)
dtich_danso %>%
arrange(desc(x2011_dan_so_trung_binh_nghin_nguoi)) %>%
slice(1:6)
dtich_danso %>%
arrange(desc(x2011_dan_so_trung_binh_nghin_nguoi))
dtich_danso %>%
arrange(desc(x2011_dien_tich_km2))
# remove the union regions
dtich_danso %>%
arrange(desc(x2011_dien_tich_km2)) %>%
select(1:6) %>%
pull(dia_phuong)
# remove the union regions
dtich_danso %>%
arrange(desc(x2011_dien_tich_km2)) %>%
slice(1:6) %>%
pull(dia_phuong)
# remove the union regions
union_regions <- dtich_danso %>%
arrange(desc(x2011_dien_tich_km2)) %>%
slice(1:6) %>%
pull(dia_phuong)
dtich_danso %>%
pivot_longer(-dia_phuong, names_to = c("year", ".value"), names_pattern = "x(\\d{4})_(.*)") %>%
mutate(dia_phuong = str_to_title(dia_phuong)) %>%
filter(!(dia_phuong %in% union_regions))
union_regions
dtich_danso %>%
filter(!(dia_phuong %in% union_regions)) %>%
pivot_longer(-dia_phuong, names_to = c("year", ".value"), names_pattern = "x(\\d{4})_(.*)") %>%
mutate(dia_phuong = str_to_title(dia_phuong))
union_regions
# remove the union regions
union_regions <- dtich_danso %>%
arrange(desc(x2011_dien_tich_km2)) %>%
slice(1:7) %>%
pull(dia_phuong)
union_regions
dtich_danso %>%
filter(!(dia_phuong %in% union_regions)) %>%
pivot_longer(-dia_phuong, names_to = c("year", ".value"), names_pattern = "x(\\d{4})_(.*)") %>%
mutate(dia_phuong = str_to_title(dia_phuong))
read_csv("raw-data/gioitinh.csv")
gioi_tinh <- read_csv("raw-data/gioitinh.csv")
gioi_tinh
gioi_tinh <- read_csv("raw-data/gioitinh.csv") %>%
janitor::clean_names()
dtich_danso <- read_csv("raw-data/dientich_danso.csv") %>%
janitor::clean_names()
# remove the union regions
union_regions <- dtich_danso %>%
arrange(desc(x2011_dien_tich_km2)) %>%
slice(1:7) %>%
pull(dia_phuong)
dtich_danso %>%
filter(!(dia_phuong %in% union_regions)) %>%
pivot_longer(-dia_phuong, names_to = c("year", ".value"), names_pattern = "x(\\d{4})_(.*)") %>%
mutate(dia_phuong = str_to_title(dia_phuong))
gioi_tinh <- read_csv("raw-data/gioitinh.csv") %>%
janitor::clean_names()
gioi_tinh
gioi_tinh %>%
filter(!(dia_phuong %in% union_regions)) %>%
pivot_longer(-tinh_thanh_pho, names_to = c(".value", "year"), names_pattern = "(.*)_(year)")
gioi_tinh %>%
filter(!(tinh_thanh_pho %in% union_regions)) %>%
pivot_longer(-tinh_thanh_pho, names_to = c(".value", "year"), names_pattern = "(.*)_(year)")
gioi_tinh %>%
filter(!(tinh_thanh_pho %in% union_regions)) %>%
pivot_longer(-tinh_thanh_pho, names_to = c(".value", "year"), names_pattern = "(.*)_(year)")
tinh_thanh_pho
gioi_tinh %>%
pivot_longer(-tinh_thanh_pho, names_to = c(".value", "year"), names_pattern = "(.*)_(year)")
View(gioi_tinh)
gioi_tinh %>%
filter(!(tinh_thanh_pho %in% union_regions))
gioi_tinh %>%
filter(!(tinh_thanh_pho %in% union_regions)) %>%
pivot_longer(-tinh_thanh_pho, names_to = c(".value", "year"), names_pattern = "(.*)_(\\d{4})")
gioi_tinh %>%
mutate(across(everything(), as.character))
gioi_tinh %>%
mutate(across(everything(), as.character)) %>%
filter(!(tinh_thanh_pho %in% union_regions)) %>%
pivot_longer(-tinh_thanh_pho, names_to = c(".value", "year"), names_pattern = "(.*)_(\\d{4})")
gioi_tinh %>%
mutate(across(everything(), as.character)) %>%
filter(!(tinh_thanh_pho %in% union_regions)) %>%
pivot_longer(-tinh_thanh_pho, names_to = c("category", "year"), names_pattern = "(.*)_(\\d{4})")
union_regions
gioi_tinh
gioi_tinh %>%
mutate(across(everything(), as.character)) %>%
filter(!(tinh_thanh_pho %in% union_regions)) %>%
pivot_longer(-tinh_thanh_pho, names_to = c("category", "year"), names_pattern = "(.*)_(\\d{4})")
gioi_tinh %>% filter(!(tinh_thanh_pho %in% union_regions))
gioi_tinh %>% filter(!(tinh_thanh_pho %in% union_regions)) %>% distinct(tinh_thanh_pho)
gioi_tinh %>% filter(!(tinh_thanh_pho %in% union_regions)) %>% distinct(tinh_thanh_pho) %>% view()
union_regions
union_regions[7]
union_regions[7] =="Ðồng bằng sông Cửu Long"
union_regions[5] =="Ðồng bằng sông Cửu Long"
union_regions[5]
"Ðồng bằng sông Cửu Long"
gioi_tinh %>% filter(!(tinh_thanh_pho %in% union_regions)) %>%
filter(!tinh_thanh_pho %in% c("Ðồng bằng sông Hồng ","Ðông Nam Bộ", "Ðồng bằng sông Cửu Long")) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(-tinh_thanh_pho, names_to = c("category", "year"), names_pattern = "(.*)_(\\d{4})")
gioi_tinh %>% filter(!(tinh_thanh_pho %in% union_regions)) %>%
filter(!tinh_thanh_pho %in% c("Ðồng bằng sông Hồng","Ðông Nam Bộ", "Ðồng bằng sông Cửu Long")) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(-tinh_thanh_pho, names_to = c("category", "year"), names_pattern = "(.*)_(\\d{4})")
union_regions
gioi_tinh %>% filter(!(tinh_thanh_pho %in% union_regions)) %>%
filter(!tinh_thanh_pho %in% c("Ðồng bằng sông Hồng","Ðông Nam Bộ", "Ðồng bằng sông Cửu Long")) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(-tinh_thanh_pho, names_to = c("category", "year"), names_pattern = "(.*)_(\\d{4})")
gioi_tinh %>% filter(!(tinh_thanh_pho %in% union_regions)) %>%
filter(!tinh_thanh_pho %in% c("Ðồng bằng sông Hồng","Ðông Nam Bộ", "Ðồng bằng sông Cửu Long")) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(-tinh_thanh_pho, names_to = c("category", "year"), names_pattern = "(.*)_(\\d{4})") %>%
count(category)
gioi_tinh %>% filter(!(tinh_thanh_pho %in% union_regions)) %>%
filter(!tinh_thanh_pho %in% c("Ðồng bằng sông Hồng","Ðông Nam Bộ", "Ðồng bằng sông Cửu Long")) %>%
pivot_longer(-tinh_thanh_pho, names_to = c("category", "year"), names_pattern = "(.*)_(\\d{4})",
values_transform = as.double() ) %>%
count(category)
gioi_tinh %>% filter(!(tinh_thanh_pho %in% union_regions)) %>%
filter(!tinh_thanh_pho %in% c("Ðồng bằng sông Hồng","Ðông Nam Bộ", "Ðồng bằng sông Cửu Long")) %>%
pivot_longer(-tinh_thanh_pho, names_to = c("category", "year"), names_pattern = "(.*)_(\\d{4})",
values_transform = as.double) %>%
count(category)
gioi_tinh %>% filter(!(tinh_thanh_pho %in% union_regions)) %>%
filter(!tinh_thanh_pho %in% c("Ðồng bằng sông Hồng","Ðông Nam Bộ", "Ðồng bằng sông Cửu Long")) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(-tinh_thanh_pho, names_to = c("category", "year"), names_pattern = "(.*)_(\\d{4})",
names_repair = "minimal") %>%
count(category)
gioi_tinh %>% filter(!(tinh_thanh_pho %in% union_regions)) %>%
filter(!tinh_thanh_pho %in% c("Ðồng bằng sông Hồng","Ðông Nam Bộ", "Ðồng bằng sông Cửu Long")) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(-tinh_thanh_pho, names_to = c("category", "year"), names_pattern = "(.*)_(\\d{4})",
names_repair = "minimal") %>%
mutate(category = case_when(str_detect(category, "nam")~ "male",
str_detect(category, "nong_thon")~ "rural",
str_detect(category, "thanh_thi")~ "urban",
TRUE ~ "total"))
gioi_tinh %>% filter(!(tinh_thanh_pho %in% union_regions)) %>%
filter(!tinh_thanh_pho %in% c("Ðồng bằng sông Hồng","Ðông Nam Bộ", "Ðồng bằng sông Cửu Long")) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(-tinh_thanh_pho, names_to = c("category", "year"), names_pattern = "(.*)_(\\d{4})",
names_repair = "minimal") %>%
mutate(category = case_when(str_detect(category, "nam")~ "male",
str_detect(category, "nong_thon")~ "rural",
str_detect(category, "thanh_thi")~ "urban",
TRUE ~ "total")) %>%
count(category)
gioi_tinh %>% filter(!(tinh_thanh_pho %in% union_regions)) %>%
filter(!tinh_thanh_pho %in% c("Ðồng bằng sông Hồng","Ðông Nam Bộ", "Ðồng bằng sông Cửu Long")) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(-tinh_thanh_pho, names_to = c("category", "year"), names_pattern = "(.*)_(\\d{4})",
names_repair = "minimal") %>%
mutate(category = case_when(str_detect(category, "nam")~ "male",
str_detect(category, "nu")~  "female",
str_detect(category, "nong_thon")~ "rural",
str_detect(category, "thanh_thi")~ "urban",
TRUE ~ "total")) %>%
count(category)
gioi_tinh %>% filter(!(tinh_thanh_pho %in% union_regions)) %>%
filter(!tinh_thanh_pho %in% c("Ðồng bằng sông Hồng","Ðông Nam Bộ", "Ðồng bằng sông Cửu Long")) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(-tinh_thanh_pho, names_to = c("category", "year"), names_pattern = "(.*)_(\\d{4})",
names_repair = "minimal") %>%
mutate(category = case_when(str_detect(category, "nam")~ "male",
str_detect(category, "nu")~  "female",
str_detect(category, "nong_thon")~ "rural",
str_detect(category, "thanh_thi")~ "urban",
TRUE ~ "total"))
read_csv("raw-data/laodong.csv")
laodong <-  read_csv("raw-data/laodong.csv") %>%
janitor::clean_names()
laodong
laodong %>%
pivot_longer(-tinh_thanh_pho)
laodong %>%
pivot_longer(-tinh_thanh_pho, names_ptypes = list(name = as.numeric()))
laodong %>%
pivot_longer(-tinh_thanh_pho, names_ptypes = list(name = parse_number()))
laodong %>%
pivot_longer(-tinh_thanh_pho, names_ptypes = list(name = parse_number))
laodong %>%
pivot_longer(-tinh_thanh_pho, names_ptypes = list(name = "parse_number"))
laodong %>%
pivot_longer(-tinh_thanh_pho, names_ptypes = list(name = "z"))
laodong %>%
pivot_longer(-tinh_thanh_pho, names_ptypes)
laodong %>%
pivot_longer(-tinh_thanh_pho)
laodong %>%
pivot_longer(-tinh_thanh_pho, names_to = "year")
laodong %>%
pivot_longer(-tinh_thanh_pho, names_to = "year") %>%
mutate(year = parse_number(year))
laodong %>%
pivot_longer(-tinh_thanh_pho, names_to = "year") %>%
mutate(year = parse_datetime(year))
laodong %>%
pivot_longer(-tinh_thanh_pho, names_to = "year") %>%
mutate(year = parse_number(year))
gioi_tinh %>% filter(!(tinh_thanh_pho %in% union_regions)) %>%
filter(!tinh_thanh_pho %in% c("Ðồng bằng sông Hồng","Ðông Nam Bộ", "Ðồng bằng sông Cửu Long")) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(-tinh_thanh_pho, names_to = c("category", "year"), names_pattern = "(.*)_(\\d{4})",
names_repair = "minimal") %>%
mutate(category = case_when(str_detect(category, "nam")~ "male",
str_detect(category, "nu")~  "female",
str_detect(category, "nong_thon")~ "rural",
str_detect(category, "thanh_thi")~ "urban",
TRUE ~ "total"))
laodong %>%
pivot_longer(-tinh_thanh_pho, names_to = "year") %>%
mutate(year = parse_number(year))
laodong %>%
filter(!(tinh_thanh_pho %in% union_regions)) %>%
filter(!tinh_thanh_pho %in% c("Ðồng bằng sông Hồng","Ðông Nam Bộ", "Ðồng bằng sông Cửu Long")) %>%
pivot_longer(-tinh_thanh_pho, names_to = "year") %>%
mutate(year = parse_number(year))
dtich_danso <- dtich_danso %>%
filter(!(dia_phuong %in% union_regions)) %>%
pivot_longer(-dia_phuong, names_to = c("year", ".value"), names_pattern = "x(\\d{4})_(.*)") %>%
mutate(dia_phuong = str_to_title(dia_phuong))
write_rds(dtich_danso, "cleanded-data/area-population")
write_rds(dtich_danso, "cleanded-data/area-population.rds")
gioi_tinh <- gioi_tinh %>% filter(!(tinh_thanh_pho %in% union_regions)) %>%
filter(!tinh_thanh_pho %in% c("Ðồng bằng sông Hồng","Ðông Nam Bộ", "Ðồng bằng sông Cửu Long")) %>%
mutate(across(everything(), as.character)) %>%
pivot_longer(-tinh_thanh_pho, names_to = c("category", "year"), names_pattern = "(.*)_(\\d{4})",
names_repair = "minimal") %>%
mutate(category = case_when(str_detect(category, "nam")~ "male",
str_detect(category, "nu")~  "female",
str_detect(category, "nong_thon")~ "rural",
str_detect(category, "thanh_thi")~ "urban",
TRUE ~ "total"))
write_rds(gioi_tinh, "sex.rds")
write_rds(gioi_tinh, "cleanded-data/sex.rds")
laodong <- laodong %>%
filter(!(tinh_thanh_pho %in% union_regions)) %>%
filter(!tinh_thanh_pho %in% c("Ðồng bằng sông Hồng","Ðông Nam Bộ", "Ðồng bằng sông Cửu Long")) %>%
pivot_longer(-tinh_thanh_pho, names_to = "year") %>%
mutate(year = parse_number(year))
write_rds("cleanded-data/labor.rds")
write_rds(laodong, "cleanded-data/labor.rds")
